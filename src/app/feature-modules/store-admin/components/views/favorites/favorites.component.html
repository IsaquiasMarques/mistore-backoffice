<div class="wrapper">
    <div class="wrapper-header">

        <div class="top-content flex justify-between items-start">
            <div class="aside">
                <div class="title mb-4">
                    <h1 class="text-black font-extrabold text-2xl">
                        Favoritos
                    </h1>
                </div>
                <div class="tiny-text">
                    <p class="text-[#AAA] text-base">
                        Resumo dos produtos mais favoritos dos usuários
                    </p>
                </div>
            </div>
            <div class="actions-chips flex gap-8 justify-start items-center">
    
                <div class="chip border bg-white w-fit border-black rounded-lg">
                    <button class="text-black font-semibold p-4 flex gap-2 justify-center items-center">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M14 6.66683H2M10.6667 1.3335V4.00016M5.33333 1.3335V4.00016M5.2 14.6668H10.8C11.9201 14.6668 12.4802 14.6668 12.908 14.4488C13.2843 14.2571 13.5903 13.9511 13.782 13.5748C14 13.147 14 12.5869 14 11.4668V5.86683C14 4.74672 14 4.18667 13.782 3.75885C13.5903 3.38252 13.2843 3.07656 12.908 2.88482C12.4802 2.66683 11.9201 2.66683 10.8 2.66683H5.2C4.0799 2.66683 3.51984 2.66683 3.09202 2.88482C2.71569 3.07656 2.40973 3.38252 2.21799 3.75885C2 4.18667 2 4.74672 2 5.86683V11.4668C2 12.5869 2 13.147 2.21799 13.5748C2.40973 13.9511 2.71569 14.2571 3.09202 14.4488C3.51984 14.6668 4.0799 14.6668 5.2 14.6668Z" stroke="black" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        Selecionar data
                    </button>
                </div>
                <div class="chip border border-black bg-white w-fit rounded-lg p-4">
                    <button class="text-black font-semibold flex gap-2 justify-center items-center">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M14 10V10.8C14 11.9201 14 12.4802 13.782 12.908C13.5903 13.2843 13.2843 13.5903 12.908 13.782C12.4802 14 11.9201 14 10.8 14H5.2C4.07989 14 3.51984 14 3.09202 13.782C2.71569 13.5903 2.40973 13.2843 2.21799 12.908C2 12.4802 2 11.9201 2 10.8V10M11.3333 6.66667L8 10M8 10L4.66667 6.66667M8 10V2" stroke="black" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        Baixar Relatório
                    </button>
                </div>
    
            </div>
        </div>
        <div class="widgets mt-10 flex gap-6 flex-wrap justify-start items-center">
            @for (widget of this.widgets; track $index) {
                <mi-widget
                [widgetBackground]="widget.backgroundColor"
                [widgetMainTextColor]="widget.mainTextColor"
                class="widget w-[calc(32.98%-12px)]"
                >
                    <div class="w-description flex gap-2 justify-between items-center"
                    slot="widget-description"
                    >
                        <mi-svg
                        [reference]="widget.svgIcon.ref"
                        [color]="widget.svgIcon.color"
                        />
                        <p class="">
                            {{ widget.headerLabel }}
                        </p>
                    </div>
                    <div class="cta-dots"
                    slot="widget-cta-dots"
                    >
                        <button>
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M13 12C13 11.4477 12.5523 11 12 11C11.4477 11 11 11.4477 11 12C11 12.5523 11.4477 13 12 13C12.5523 13 13 12.5523 13 12Z" [attr.stroke]="widget.ctaDotsColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M6 12C6 11.4477 5.55228 11 5 11C4.44772 11 4 11.4477 4 12C4 12.5523 4.44772 13 5 13C5.55228 13 6 12.5523 6 12Z" [attr.stroke]="widget.ctaDotsColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M20 12C20 11.4477 19.5523 11 19 11C18.4477 11 18 11.4477 18 12C18 12.5523 18.4477 13 19 13C19.5523 13 20 12.5523 20 12Z" [attr.stroke]="widget.ctaDotsColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                    </div>
                    <div class="big-content mb-2"
                    slot="widget-big-content"
                    >
                        <h1 class=" text-[2.5rem] font-extrabold leading-[3rem]">
                            {{ widget.data.main | number | replaceBy }}
                        </h1>
                    </div>
                    <div class="widget-footer"
                    slot="widget-footer"
                    >
                        <p class="flex gap-x-1 justify-start text-sm items-center"
                        [style.color]="widget.footerTextColor"
                        >
                            @if (widget.data.percentageStatus === widgetPercentageStatusEnum.ENCREASE) {
                                <span class="increasing !text-[#61C554] flex justify-start items-center">
                                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M4 12L12 4M12 4H6.66667M12 4V9.33333" stroke="#61C554" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"/>
                                    </svg>
                                    {{ widget.data.percentageValue }}%
                                </span>
                            } @else {
                                <span class="decreasing !text-[#ED695E] flex justify-start items-center">
                                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M4 4L12 12M12 12V6.66667M12 12H6.66667" stroke="#ED695E" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"/>
                                    </svg>
                                    {{ widget.data.percentageValue }}%
                                </span>
                            }
                            {{ widget.data.footerLabelValue| number | replaceBy }} {{ widget.data.footerLabelText }}
                        </p>
                    </div>
                </mi-widget>
            }
        </div>
    </div>
    <div class="wrapper-content mt-10">
        <div class="table-section mt-10 py-6 w-full rounded-lg border border-[rgba(233,233,233,0.60)] bg-white flex flex-col gap-y-10">
            
            <div class="table-header px-6 flex justify-between items-start">
                <div class="table-header-aside">
                    <div class="title mb-4">
                        <h1 class="text-black font-bold text-lg">
                            Produtos favoritos
                        </h1>
                    </div>
                    <div class="tiny-text">
                        <p class="text-[#AAA] text-base">
                            Lista dos produtos favoritados pelos os usuários
                        </p>
                    </div>
                </div>
                <div class="table-header-actions-chips flex gap-8 justify-start items-center">
        
                    <div class="chip border bg-white w-fit border-[#E9E9E9] rounded-lg">
                        <button class="text-black font-semibold p-4 flex gap-2 justify-center items-center">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M4 8H12M2 4H14M6 12H10" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            Filtrar
                        </button>
                    </div>
        
                </div>
            </div>
            <div class="table-content relative">
                <mi-table
                [pagination]="true"
                [route]="this.route"
                [perPage]="this.perPage"
                [currentPage]="this.currentPage"
                [totalItems]="this.totalItems"
                >
                    <thead class="bg-[#F8F8F8] sticky z-[5] w-full left-0 text-left"
                    #theadElementRef
                    [style.top.px]="TABLE_STICKY_TOP"
                    slot="table-header"
                    >
                        <tr class="text-sm">
                            <th class="relative py-4 px-6" *ngIf="this.checkbox">
                                <label class="checkbox-container"
                                [ngClass]="{
                                    'all-checked': this.selectedItems.length === this.totalItems,
                                    'some-checked': this.selectedItems.length > 0  && (this.selectedItems.length < this.totalItems) 
                                }"
                                >
                                    <input type="checkbox"
                                    (click)="this.toggleSelect()"
                                    [checked]="this.selectedItems.length > 0"
                                    >
                                    <span class="checkmark"></span>
                                </label>
                            </th>
                            <th class="py-4 px-6" *ngFor="let item of this.tableHeader">{{ item }}</th>
                        </tr>
                    </thead>
                    <tbody
                    slot="table-body"
                    >
                        @if (!(this.loaderService.getLoadingStatus(this.pageLoaderIdentifier.PRODUCTS) | async)) {
                            @if(this.tableProducts.length > 0){
                                @if (this.selectedItems.length > 0) {
                                    <tr class="text-sm appear-softly sticky bg-white z-[5] w-full left-0"
                                    [style.top.px]="selectedDetailsStickyTopSpacing"
                                    >
                                        <td colspan="7" class="text-left pl-4 pr-10 py-4 font-medium">
                                            <div class="selected-details flex justify-between items-center">
                                                <div class="aside">
                                                    <p class="text-[#999]">
                                                        {{ this.selectedItems.length }} / <span class="text-black">{{ this.totalItems }}</span>
                                                        Selecionado{{ this.selectedItems.length > 1 ? 's' : '' }}
                                                    </p>
                                                </div>
                                                <div class="buttons flex gap-5 justify-center items-center">
                                                    <button class="">
                                                        <svg width="34" height="34" viewBox="0 0 34 34" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                            <rect x="0.5" y="0.5" width="33" height="33" rx="3.5" fill="#F8F8F8"/>
                                                            <rect x="0.5" y="0.5" width="33" height="33" rx="3.5" stroke="#F2F2F2"/>
                                                            <path d="M21.1668 15.3333V13.6667C21.1668 11.3655 19.3013 9.5 17.0002 9.5C14.699 9.5 12.8335 11.3655 12.8335 13.6667V15.3333M17.0002 19.0833V20.75M14.3335 24.5H19.6668C21.067 24.5 21.767 24.5 22.3018 24.2275C22.7722 23.9878 23.1547 23.6054 23.3943 23.135C23.6668 22.6002 23.6668 21.9001 23.6668 20.5V19.3333C23.6668 17.9332 23.6668 17.2331 23.3943 16.6984C23.1547 16.228 22.7722 15.8455 22.3018 15.6058C21.767 15.3333 21.067 15.3333 19.6668 15.3333H14.3335C12.9334 15.3333 12.2333 15.3333 11.6985 15.6058C11.2281 15.8455 10.8457 16.228 10.606 16.6984C10.3335 17.2331 10.3335 17.9332 10.3335 19.3333V20.5C10.3335 21.9001 10.3335 22.6002 10.606 23.135C10.8457 23.6054 11.2281 23.9878 11.6985 24.2275C12.2333 24.5 12.9334 24.5 14.3335 24.5Z" stroke="black" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"/>
                                                        </svg>
                                                    </button>
                                                    <button class="">
                                                        <svg width="34" height="34" viewBox="0 0 34 34" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                            <rect width="34" height="34" rx="4" fill="#E13029"/>
                                                            <path d="M20.3333 11.9998V11.3332C20.3333 10.3997 20.3333 9.93304 20.1517 9.57652C19.9919 9.26292 19.7369 9.00795 19.4233 8.84816C19.0668 8.6665 18.6001 8.6665 17.6667 8.6665H16.3333C15.3999 8.6665 14.9332 8.6665 14.5767 8.84816C14.2631 9.00795 14.0081 9.26292 13.8483 9.57652C13.6667 9.93304 13.6667 10.3997 13.6667 11.3332V11.9998M15.3333 16.5832V20.7498M18.6667 16.5832V20.7498M9.5 11.9998H24.5M22.8333 11.9998V21.3332C22.8333 22.7333 22.8333 23.4334 22.5608 23.9681C22.3212 24.4386 21.9387 24.821 21.4683 25.0607C20.9335 25.3332 20.2335 25.3332 18.8333 25.3332H15.1667C13.7665 25.3332 13.0665 25.3332 12.5317 25.0607C12.0613 24.821 11.6788 24.4386 11.4392 23.9681C11.1667 23.4334 11.1667 22.7333 11.1667 21.3332V11.9998" stroke="white" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"/>
                                                        </svg>
                                                    </button>
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                }
                                @for (product of this.tableProducts; track $index) {
                                    <tr class="text-sm appear-softly">
                                        <td class="relative py-4 px-6"
                                        *ngIf="this.checkbox"
                                        >
                                            <label class="checkbox-container">
                                                <input
                                                type="checkbox"
                                                [checked]="isSelected(product.id, 'checked')"
                                                (click)="selectItem(product.id)"
                                                >
                                                <span class="checkmark"></span>
                                            </label>
                                        </td>
                                        <td class="py-4 px-6">
                                            <div class="product-details flex gap-x-2 justify-start items-center">
                                                <div class="image w-12 h-12 overflow-hidden"
                                                *ngIf="this.withImage"
                                                [ngClass]="{
                                                    'rounded-full': this.imageRadius == 'full',
                                                    'rounded': this.imageRadius == 'lg',
                                                }"
                                                >
                                                    <img src="{{ (product.imagePath != '') ? product.imagePath : 'assets/images/products/no-image.png' }}" class="w-full h-full object-cover object-center" alt="">
                                                </div>
                                                <div class="product max-w-[10.625rem] flex flex-col gap-y-2 justify-between items-start">
                                                    <h1 class="text-black text-sm leading-4 font-medium limited-text one-line">
                                                        {{ product.name }}
                                                    </h1>
                                                    <p
                                                    *ngIf="this.withTinyText"
                                                    class="text-sm text-[#aaa] leading-4 limited-text one-line">
                                                        ID: {{ product.ID }}
                                                    </p>
                                                </div>
                                            </div>
                                        </td>
                                        <td class="py-4 px-6 text-[#828282]">{{ product.category }}</td>
                                        <td class="py-4 px-6 text-[#828282]">{{ product.quantity | number | replaceBy: ',' : ' ' }}</td>
                                        <td class="py-4 px-6 text-[#828282]">{{ product.created_at }}</td>
                                        <td class="py-4 px-6 text-[#828282]">{{ product.price| number | replaceBy }} AOA</td>
                                        <td class="py-4 px-6">
                                            <button class="chip py-1 px-2 items-center flex gap-x-2 justify-center rounded-full font-medium border border-[#E9E9E9]"
                                            [style.backgroundColor]="'#F8F8F8'"
                                            [style.color]="'#999'"
                                            >
                                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                    <path d="M13.4258 2.5C16.3609 2.5 18.3332 5.29375 18.3332 7.9C18.3332 13.1781 10.148 17.5 9.99984 17.5C9.85169 17.5 1.6665 13.1781 1.6665 7.9C1.6665 5.29375 3.63873 2.5 6.57391 2.5C8.2591 2.5 9.36095 3.35312 9.99984 4.10312C10.6387 3.35312 11.7406 2.5 13.4258 2.5Z" fill="black" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                                </svg>
                                                {{ product.favoritesCount | number | replaceBy }}
                                            </button>
                                        </td>
                                    </tr>
                                }
                            } @else {
                                <tr class="text-sm appear-softly">
                                    <td colspan="7" class="text-left px-6 py-4 font-medium">
                                        Sem produtos cadastrados.
                                    </td>
                                </tr>
                            }
                        } @else {
                            @for(placeholder of this.generatePlaceholders(); track $index){
                                <tr class="text-sm appear-softly">
                                    <td class="relative py-4 px-6" *ngIf="this.checkbox">
                                        <label class="checkbox-container relative">
                                            <span class="checkmark-placeholder placeholder !relative !w-6 !h-6"></span>
                                        </label>
                                    </td>
                                    <td class="py-4 px-6">
                                        <div class="product-details flex gap-x-2 justify-start items-center">
                                            <div class="image relative w-12 h-12 overflow-hidden"
                                            *ngIf="this.withImage"
                                            [ngClass]="{
                                                'rounded-full': this.imageRadius == 'full',
                                                'rounded': this.imageRadius == 'lg',
                                            }"
                                            >
                                                <div class="placeholder"></div>
                                            </div>
                                            <div class="product max-w-[10.625rem] flex flex-col gap-y-2 justify-between items-start">
                                                <h1 class="text-transparent !relative placeholder text-sm leading-4 font-medium limited-text one-line">
                                                    Texto médio para o skeleton
                                                </h1>
                                                <p
                                                *ngIf="this.withTinyText"
                                                class="text-sm !relative !w-fit placeholder text-transparent leading-4 limited-text one-line">
                                                    Texto Pequeno
                                                </p>
                                            </div>
                                        </div>
                                    </td>
                                    <td class="py-4 px-6 text-transparent">
                                        <p class="placeholder !relative !w-fit">Texto pequeno</p>
                                    </td>
                                    <td class="py-4 px-6 text-transparent">
                                        <p class="placeholder !relative !w-fit">Texto pequeno</p>
                                    </td>
                                    <td class="py-4 px-6 text-transparent">
                                        <p class="placeholder !relative !w-fit">Texto pequeno</p>
                                    </td>
                                    <td class="py-4 px-6 text-transparent">
                                        <p class="placeholder !relative !w-fit">Texto pequeno</p>
                                    </td>
                                    <td class="py-4 px-6">
                                        <button class="chip placeholder text-transparent !relative !w-fit py-1 px-2 rounded-full font-medium">
                                            Texto pequeno
                                        </button>
                                    </td>
                                </tr>
                            }
                        }
                    </tbody>
                </mi-table>
            </div>

        </div>

    </div>
</div>